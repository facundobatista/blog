2017-04-25 22:12:55
Texto coloreado en LibreOffice
<tags>



A los que armamos presentaciones mostrando programitas o pequeñas porciones de código siempre se nos presentó un inconveniente: ¿cómo mostrar ese código apropiadamente coloreado?

Con "apropiadamente coloreado" no me refiero a pintarrajeado como adolescente que sale a bailar, o decorado con florcitas, soles, y/o aviones de guerra, sino a algo que es típico en el mundo de la programación donde los editores le ponen distintos colores a las palabras que forman el código en función de qué tipo de palabra son: un color para las variables, otro para los textos, otro para los nombres de las funciones, otro para...

No voy a entrar en detalle sobre qué es ese coloreado (que en inglés llamamos "syntax highlighting"), pero les muestro un ejemplo:

<img src="http://www.taniquetil.com.ar/facundo/imgs/codcolor.png" alt="Ejemplo de código coloreado" width="680" height="258" />

En fin, volviendo a meter código coloreado en LibreOffice. Lo charlé bastante en su momento con varias personas, lo mejor parecía capturar una imagen del código y meter eso, pero es una porquería porque no queda bien ante el menor cambio de tamaño, y si encima hay que tocar cualquier cosa de ese texto es imposible.

También buscando encontré <a href="https://extensions.libreoffice.org/extensions/coooder">Coooder</a>, que es una extensión de LibreOffice que <em>hacía</em> exactamente eso. El verbo hacer de la oración anterior está en pasado porque sólo funciona para los LibreOffice del 3.3 a 3.6 (yo actualmente tengo 5.1).

Finalmente encontré la manera de hacerlo! No es la más directa, pero el resultado es el que estaba buscando: un texto coloreado dentro de LibreOffice. Genial!

Los pasos se dividen en dos partes grandes:
<ul>
<li>generar un documento en formato RTF</li>
<li>meter este doc RTF en la presentación</li>
</ul>

Cómo generar el doc RTF:
<ul>
<li>Abrir el código con <a href="http://www.vim.org/download.php">gvim</a></li>
<li>Escribir <span style="font-family: courier new,courier;">:TOhtml</span>, lo cual abrirá otra ventana con el código HTML correspondiente a nuestro texto coloreado.</li>
<li>Escribir <span style="font-family: courier new,courier;">:saveas /tmp/cod.html</span>, lo cual grabará ese HTML en el path ahí especificado</li>
<li>Cerrar cualquier libreffice abierto (sino el próximo paso falla :/).</li>
<li>Desde una terminal, ejecutar <span style="font-family: courier new,courier;">unoconv -f rtf /tmp/cod.html</span> lo cual nos dejará un archivo en <span style="font-family: courier new,courier;">/tmp/cod.rtf</span> justamente con el código nuestro, en formato RTF.</li>
<li>Abrir el LibreOffice Impress</li>
<li>Ir al Menu, Insertar, Archivo; un par de clicks en "siguiente" y ya tenemos el texto adentro.</li>
<li>Seleccionar el texto que acabamos de insertar, y cambiarle la tipografía a alguna monoespaciada.</li>
</ul>

Voil&agrave;!

 |
